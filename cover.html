
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<style>
			body {
				background: black;
				color: rgb(80, 80, 80);
			}
			body, pre, #legend span {
				font-family: Menlo, monospace;
				font-weight: bold;
			}
			#topbar {
				background: black;
				position: fixed;
				top: 0; left: 0; right: 0;
				height: 42px;
				border-bottom: 1px solid rgb(80, 80, 80);
			}
			#content {
				margin-top: 50px;
			}
			#nav, #legend {
				float: left;
				margin-left: 10px;
			}
			#legend {
				margin-top: 12px;
			}
			#nav {
				margin-top: 10px;
			}
			#legend span {
				margin: 0 5px;
			}
			.cov0 { color: rgb(192, 0, 0) }
.cov1 { color: rgb(128, 128, 128) }
.cov2 { color: rgb(116, 140, 131) }
.cov3 { color: rgb(104, 152, 134) }
.cov4 { color: rgb(92, 164, 137) }
.cov5 { color: rgb(80, 176, 140) }
.cov6 { color: rgb(68, 188, 143) }
.cov7 { color: rgb(56, 200, 146) }
.cov8 { color: rgb(44, 212, 149) }
.cov9 { color: rgb(32, 224, 152) }
.cov10 { color: rgb(20, 236, 155) }

		</style>
	</head>
	<body>
		<div id="topbar">
			<div id="nav">
				<select id="files">
				
				<option value="file0">github.com/kamontat/go-error-manager/err_manager.go (100.0%)</option>
				
				<option value="file1">github.com/kamontat/go-error-manager/err_manager_throw.go (92.3%)</option>
				
				</select>
			</div>
			<div id="legend">
				<span>not tracked</span>
			
				<span class="cov0">no coverage</span>
				<span class="cov1">low coverage</span>
				<span class="cov2">*</span>
				<span class="cov3">*</span>
				<span class="cov4">*</span>
				<span class="cov5">*</span>
				<span class="cov6">*</span>
				<span class="cov7">*</span>
				<span class="cov8">*</span>
				<span class="cov9">*</span>
				<span class="cov10">high coverage</span>
			
			</div>
		</div>
		<div id="content">
		
		<pre class="file" id="file0" style="display: none">package manager

import (
        "errors"
)

// ResultObserve is function receive result and modify it, then return
type ResultObserve func(result interface{}) interface{}

// ErrManager is for manage error in golang
type ErrManager struct {
        isError bool
        isThrow bool
        result  interface{}
        err     []error
}

// New is for create new error manager
func New() *ErrManager <span class="cov1" title="1">{
        return &amp;ErrManager{
                isError: false,
                isThrow: false,
                err:     []error{},
                result:  nil,
        }
}</span>

var errorManager = New()

// StartManageError will return default ErrManager
func StartManageError() *ErrManager <span class="cov3" title="3">{
        return errorManager
}</span>

// UpdateByThrowable is use when you have throwable but you want to add more error
func UpdateByThrowable(throwable Throwable) *ErrManager <span class="cov1" title="1">{
        return StartManageError().UpdateByThrowable(throwable)
}</span>

// ResetError will reset all error in error manager
func ResetError() *ErrManager <span class="cov1" title="1">{
        return errorManager.Reset()
}</span>

// ExecuteWith1Parameters is method that call with function that return 1 parameter
func (e *ErrManager) ExecuteWith1Parameters(err error) *ErrManager <span class="cov7" title="13">{
        e.AddNewError(err)
        return e
}</span>

// ExecuteWith2Parameters is method that call with function that return 2 parameters
func (e *ErrManager) ExecuteWith2Parameters(result interface{}, err error) *ErrManager <span class="cov5" title="7">{
        e.result = result
        return e.AddNewError(err)
}</span>

// GetResult will return the result if exist and throwable
func (e *ErrManager) GetResult() (interface{}, *Throwable) <span class="cov3" title="3">{
        if !e.isError </span><span class="cov2" title="2">{
                return e.result, e.Throw()
        }</span>
        <span class="cov1" title="1">return nil, e.Throw()</span>
}

// GetResultOnly will return the result if exist, otherwise return null
func (e *ErrManager) GetResultOnly() interface{} <span class="cov4" title="4">{
        if !e.isError </span><span class="cov3" title="3">{
                return e.result
        }</span>
        <span class="cov1" title="1">return nil</span>
}

// MapResult is update exist result and return
func (e *ErrManager) MapResult(observe ResultObserve) interface{} <span class="cov3" title="3">{
        if !e.isError </span><span class="cov2" title="2">{
                return observe(e.result)
        }</span>
        <span class="cov1" title="1">return nil</span>
}

// MapAndChangeResult is update exist result and save in to Error manager
func (e *ErrManager) MapAndChangeResult(observe ResultObserve) *ErrManager <span class="cov1" title="1">{
        e.result = e.MapResult(observe)
        return e
}</span>

// SetError is tell the object that error exist. this will run when you add new error too
func (e *ErrManager) SetError() *ErrManager <span class="cov9" title="39">{
        e.isError = true
        return e
}</span>

// HaveError will return true if error exist
func (e *ErrManager) HaveError() bool <span class="cov8" title="27">{
        return e.isError
}</span>

// CountError will return true if error exist
func (e *ErrManager) CountError() int <span class="cov8" title="24">{
        return len(e.err)
}</span>

// ReplaceNewError will delete all error in collection and add input as newest one
func (e *ErrManager) ReplaceNewError(err error) *ErrManager <span class="cov3" title="3">{
        if err != nil </span><span class="cov2" title="2">{
                e.SetError()
                e.err = []error{err}
        }</span> else<span class="cov1" title="1"> {
                e.err = []error{}
        }</span>
        <span class="cov3" title="3">return e</span>
}

// AddNewError will run when have error
func (e *ErrManager) AddNewError(err error) *ErrManager <span class="cov10" title="45">{
        if e.isThrow </span><span class="cov1" title="1">{
                e.isThrow = false
                e.ReplaceNewError(err)
        }</span> else<span class="cov9" title="44"> if err != nil </span><span class="cov9" title="36">{
                e.SetError()
                e.err = append(e.err, err)
        }</span>
        <span class="cov10" title="45">return e</span>
}

// AddNewErrorMessage will run when have error message
func (e *ErrManager) AddNewErrorMessage(message string) *ErrManager <span class="cov8" title="21">{
        if message != "" </span><span class="cov8" title="20">{
                return e.AddNewError(errors.New(message))
        }</span>
        <span class="cov1" title="1">return e</span>
}

// UpdateByThrowable is use when you have throwable but you want to add more error
func (e *ErrManager) UpdateByThrowable(throwable Throwable) *ErrManager <span class="cov1" title="1">{
        e.isError = !throwable.isEmpty
        e.isThrow = false
        e.err = throwable.err
        return e
}</span>

// Throw will throw error out with default message
func (e *ErrManager) Throw() *Throwable <span class="cov6" title="12">{
        e.isThrow = true
        if e.isError </span><span class="cov5" title="6">{
                e.isError = false
                return createThrowable(e.err, createErrorMessage)
        }</span>
        <span class="cov5" title="6">return createEmptyThrowable()</span>
}

// ThrowWithMessage will throw error out with custom message
func (e *ErrManager) ThrowWithMessage(message MessageGenerator) *Throwable <span class="cov2" title="2">{
        e.isThrow = true
        if e.isError </span><span class="cov1" title="1">{
                e.isError = false
                return createThrowable(e.err, message)
        }</span>
        <span class="cov1" title="1">return createEmptyThrowable()</span>
}

// Reset will delete all error in manager.
// This also call with you call throw, throwWithMessage
func (e *ErrManager) Reset() *ErrManager <span class="cov9" title="32">{
        e.isError = false
        e.isThrow = false
        e.err = []error{}
        e.result = nil
        return e
}</span>
</pre>
		
		<pre class="file" id="file1" style="display: none">package manager

import (
        "fmt"
        "os"
)

// MessageGenerator is function for generate error message
type MessageGenerator func(errs []error) string

// Throwable is object for throw or output error message
type Throwable struct {
        isEmpty bool
        err     []error
        code    int
        message string
}

// CanBeThrow will return boolean, is throwable can be throw
func (t *Throwable) CanBeThrow() bool <span class="cov9" title="12">{
        return !t.isEmpty &amp;&amp; len(t.err) &gt; 0
}</span>

// GetMessage will return error message
func (t *Throwable) GetMessage() string <span class="cov7" title="6">{
        return t.message
}</span>

// ListErrors will return list of error
func (t *Throwable) ListErrors() []error <span class="cov8" title="8">{
        return t.err
}</span>

// Exit :run os.Exit with default code
func (t *Throwable) Exit() <span class="cov4" title="3">{
        if t.CanBeThrow() </span><span class="cov0" title="0">{
                os.Exit(t.code)
        }</span>
}

// ExitWithCode :run os.Exit with custom code
func (t *Throwable) ExitWithCode(code int) <span class="cov1" title="1">{
        t.code = code
        t.Exit()
}</span>

// @MessageGenerator
func createErrorMessage(errs []error) string <span class="cov7" title="6">{
        str := "Errors: \n"
        for i, err := range errs </span><span class="cov10" title="14">{
                str += fmt.Sprintf("\t %d) %s\n", i, err.Error())
        }</span>
        <span class="cov7" title="6">return str</span>
}

func createThrowable(errs []error, message MessageGenerator) *Throwable <span class="cov7" title="7">{
        return &amp;Throwable{
                isEmpty: false,
                err:     errs,
                message: message(errs),
                code:    1,
        }
}</span>

func createEmptyThrowable() *Throwable <span class="cov7" title="7">{
        return &amp;Throwable{
                isEmpty: true,
                code:    0,
                err:     []error{},
                message: "",
        }
}</span>
</pre>
		
		</div>
	</body>
	<script>
	(function() {
		var files = document.getElementById('files');
		var visible;
		files.addEventListener('change', onChange, false);
		function select(part) {
			if (visible)
				visible.style.display = 'none';
			visible = document.getElementById(part);
			if (!visible)
				return;
			files.value = part;
			visible.style.display = 'block';
			location.hash = part;
		}
		function onChange() {
			select(files.value);
			window.scrollTo(0, 0);
		}
		if (location.hash != "") {
			select(location.hash.substr(1));
		}
		if (!visible) {
			select("file0");
		}
	})();
	</script>
</html>
